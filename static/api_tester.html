<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GMTools API Ë∞ÉËØïÂô®</title>
    <style>
        :root {
            --bg-color: #1e1e1e;
            --sidebar-bg: #252526;
            --panel-bg: #1e1e1e;
            --header-bg: #333333;
            --border-color: #3e3e42;
            --text-color: #cccccc;
            --accent-color: #007acc;
            --accent-hover: #0098ff;
            --success-color: #4ec9b0;
            --error-color: #f48771;
            --input-bg: #3c3c3c;
            --console-bg: #1e1e1e;
        }

        body {
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
        }

        .header {
            height: 50px;
            background-color: var(--header-bg);
            display: flex;
            align-items: center;
            padding: 0 20px;
            border-bottom: 1px solid var(--border-color);
            font-size: 14px;
            justify-content: space-between;
        }

        .header-title {
            font-weight: bold;
        }

        .auth-section {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .auth-section input {
            background-color: var(--input-bg);
            border: 1px solid var(--border-color);
            color: white;
            padding: 6px 10px;
            border-radius: 2px;
            width: 150px;
        }

        .auth-section button {
            padding: 6px 12px;
            border: none;
            border-radius: 2px;
            cursor: pointer;
            font-size: 12px;
            background-color: var(--accent-color);
            color: white;
        }

        .auth-section button:hover {
            background-color: var(--accent-hover);
        }

        .auth-section .logout-btn {
            background-color: #d13438;
        }

        .auth-status {
            padding: 4px 10px;
            border-radius: 2px;
            font-size: 12px;
        }

        .auth-status.logged-in {
            background-color: var(--success-color);
            color: #000;
        }

        .auth-status.logged-out {
            background-color: var(--error-color);
            color: #000;
        }

        .container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .sidebar {
            width: 200px;
            background-color: var(--sidebar-bg);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: 10px;
            font-weight: bold;
            text-transform: uppercase;
            font-size: 12px;
            color: #858585;
        }

        .module-list {
            list-style: none;
            padding: 0;
            margin: 0;
            overflow-y: auto;
        }

        .module-item {
            padding: 10px 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            font-size: 13px;
        }

        .module-item:hover {
            background-color: #2a2d2e;
        }

        .module-item.active {
            background-color: #37373d;
            color: white;
            border-left: 3px solid var(--accent-color);
        }

        .content {
            flex: 1;
            display: flex;
            flex-direction: column;
            background-color: var(--panel-bg);
        }

        .function-bar {
            background-color: var(--sidebar-bg);
            border-bottom: 1px solid var(--border-color);
            padding: 10px;
            display: flex;
            gap: 10px;
            overflow-x: auto;
        }

        .func-btn {
            background-color: var(--input-bg);
            border: 1px solid var(--border-color);
            color: var(--text-color);
            padding: 6px 12px;
            cursor: pointer;
            border-radius: 2px;
            white-space: nowrap;
            font-size: 12px;
        }

        .func-btn:hover {
            background-color: #4e4e4e;
        }

        .func-btn.active {
            background-color: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
        }

        .form-area {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-label {
            display: block;
            margin-bottom: 5px;
            font-size: 13px;
            font-weight: 600;
        }

        .form-input {
            width: 100%;
            max-width: 500px;
            padding: 8px;
            background-color: var(--input-bg);
            border: 1px solid var(--border-color);
            color: white;
            border-radius: 2px;
            font-family: Consolas, monospace;
        }

        .form-input:focus {
            border-color: var(--accent-color);
            outline: none;
        }

        .action-bar {
            padding: 15px 20px;
            border-top: 1px solid var(--border-color);
            display: flex;
            gap: 10px;
            background-color: var(--sidebar-bg);
        }

        .btn {
            padding: 6px 16px;
            border: none;
            border-radius: 2px;
            cursor: pointer;
            font-size: 13px;
        }

        .btn-primary {
            background-color: var(--accent-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--accent-hover);
        }

        .console-panel {
            height: 250px;
            background-color: var(--console-bg);
            border-top: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
        }

        .console-header {
            padding: 5px 10px;
            background-color: var(--sidebar-bg);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 12px;
            color: #858585;
        }

        .console-output {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
            font-family: Consolas, 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.5;
        }

        .log-entry {
            margin-bottom: 8px;
            border-bottom: 1px solid #2d2d2d;
            padding-bottom: 8px;
        }

        .log-time {
            color: #858585;
            margin-right: 10px;
        }

        .log-method {
            color: #569cd6;
            font-weight: bold;
            margin-right: 10px;
        }

        .log-status.success {
            color: var(--success-color);
        }

        .log-status.error {
            color: var(--error-color);
        }

        .log-data {
            color: #ce9178;
            white-space: pre-wrap;
            margin-top: 4px;
            display: block;
        }

        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-color);
        }

        ::-webkit-scrollbar-thumb {
            background: #424242;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #4f4f4f;
        }

        .login-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .login-modal.show {
            display: flex;
        }

        .login-box {
            background: var(--sidebar-bg);
            padding: 30px;
            border-radius: 8px;
            width: 350px;
            border: 1px solid var(--border-color);
        }

        .login-box h2 {
            margin-top: 0;
            color: white;
        }

        .login-box input {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            background-color: var(--input-bg);
            border: 1px solid var(--border-color);
            color: white;
            border-radius: 2px;
        }

        .login-box button {
            width: 100%;
            padding: 10px;
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: 2px;
            cursor: pointer;
            font-size: 14px;
        }

        .login-box button:hover {
            background-color: var(--accent-hover);
        }

        .login-error {
            color: var(--error-color);
            margin-bottom: 10px;
            font-size: 12px;
        }
    </style>
</head>

<body>
    <div class="header">
        <div class="header-title">üéÆ GMTools API Ë∞ÉËØïÂô® (ÈúÄË¶ÅÁôªÂΩï)</div>
        <div class="auth-section">
            <span class="auth-status logged-out" id="authStatus">Êú™ÁôªÂΩï</span>
            <button onclick="showLoginModal()" id="loginBtn">ÁôªÂΩï</button>
            <button onclick="logout()" id="logoutBtn" class="logout-btn" style="display:none;">ÈÄÄÂá∫</button>
        </div>
    </div>

    <div class="container">
        <div class="sidebar">
            <div class="sidebar-header">Modules</div>
            <ul class="module-list" id="moduleList"></ul>
        </div>

        <div class="content">
            <div class="function-bar" id="functionBar"></div>

            <div class="form-area" id="formArea">
                <h2 id="currentFuncTitle" style="margin-top:0; font-size:18px; color:white;">ËØ∑ÂÖàÁôªÂΩïÔºåÁÑ∂ÂêéÈÄâÊã©‰∏Ä‰∏™ÂäüËÉΩ</h2>
                <div id="formInputs"></div>
            </div>

            <div class="action-bar">
                <button class="btn btn-primary" onclick="executeRequest()">ÂèëÈÄÅËØ∑Ê±Ç (Execute)</button>
                <button class="btn" style="background-color:#3c3c3c; color:white;" onclick="copyCurl()">Â§çÂà∂ cURL</button>
            </div>

            <div class="console-panel">
                <div class="console-header">
                    <span>ËøêË°åÊó•Âøó (Console)</span>
                    <button class="btn" style="background:none; color:#ccc; padding:2px;"
                        onclick="clearConsole()">Ê∏ÖÁ©∫</button>
                </div>
                <div class="console-output" id="consoleOutput"></div>
            </div>
        </div>
    </div>

    <!-- ÁôªÂΩïÊ®°ÊÄÅÊ°Ü -->
    <div class="login-modal" id="loginModal">
        <div class="login-box">
            <h2>ÁôªÂΩï GMTools</h2>
            <div class="login-error" id="loginError"></div>
            <input type="text" id="loginUsername" placeholder="Áî®Êà∑Âêç" />
            <input type="password" id="loginPassword" placeholder="ÂØÜÁ†Å" />
            <button onclick="doLogin()">ÁôªÂΩï</button>
        </div>
    </div>

    <script>
        const API_BASE = '/api';
        let accessToken = localStorage.getItem('api_tester_token') || null;
        let currentUser = null;

        const MODULES = {
            account: {
                name: "Ë¥¶Âè∑ÁÆ°ÁêÜ",
                funcs: [
                    { func: 'recharge_currency', name: 'ÂÖÖÂÄºË¥ßÂ∏Å', args: { player_id: '123456', currency_type: '‰ªôÁéâ', amount: 1000 } },
                    { func: 'send_travel_fee', name: 'ÂèëÈÄÅË∑ØË¥π', args: { account: 'test_user', player_id: '123456' } },
                    { func: 'recharge_gm_level', name: 'ÂÖÖÂÄºGMÁ≠âÁ∫ß', args: { player_id: '123456', amount: 100, gm_level: 'GM1' } },
                    { func: 'manage_account', name: 'Ë¥¶Âè∑ÁÆ°ÁêÜ', args: { command: 'Â∞ÅÁ¶ÅË¥¶Âè∑', target_id: 'test_user', id_type: 'Ë¥¶Âè∑' } },
                    { func: 'change_password', name: '‰øÆÊîπÂØÜÁ†Å', args: { account: 'test_user', new_password: 'new_password123' } },
                    { func: 'give_title', name: 'Áªô‰∫àÁß∞Ë∞ì', args: { player_id: '123456', title: 'Ëá≥Â∞äVIP' } },
                    { func: 'recharge_skill', name: 'ÂÖÖÂÄºÁªèÈ™å/ÊäÄËÉΩ', args: { player_id: '123456', amount: 10000, skill_type: 'ÂÖÖÂÄºÁªèÈ™å' } },
                    { func: 'recharge_faction', name: 'ÂÖÖÂÄºÂ∏ÆÊ¥æ/ÁßØÂàÜ', args: { player_id: '123456', amount: 500, faction_type: 'ÂÖÖÂÄºÂ∏ÆË¥°' } },
                    { func: 'recharge_gm_coin', name: 'ÂÖÖÂÄºGMÂ∏Å', args: { player_id: '123456', amount: 100 } },
                    { func: 'recharge_record', name: 'ÂÖÖÂÄºËÆ∞ÂΩï', args: { player_id: '123456' } },
                    { func: 'set_bagua', name: 'ÂÖ´Âç¶ËÆæÁΩÆ', args: { bagua_name: '‰πæ' } }
                ]
            },
            pet: {
                name: "ÂÆùÂÆùÁÆ°ÁêÜ",
                funcs: [
                    { func: 'get_pet_info', name: 'Ëé∑ÂèñÂÆùÂÆù‰ø°ÊÅØ', args: { char_id: '123456' } },
                    { func: 'modify_pet', name: '‰øÆÊîπÂÆùÂÆù', args: { char_id: '123456', pet_index: 1, modify_data: { 'Á≠âÁ∫ß': 180, 'Ê∞îË°Ä': 10000 } } },
                    { func: 'activate_merit', name: 'ÊøÄÊ¥ªÂäüÂæ∑ÂΩï', args: { char_id: '123456' } },
                    { func: 'custom_pet_equip', name: 'ÂÆöÂà∂ÂÆùÂÆùË£ÖÂ§á', args: { char_id: '123456', equip_data: { 'type': 'Êä§ËÖï', 'level': 150 } } }
                ]
            },
            equipment: {
                name: "Ë£ÖÂ§áÁÆ°ÁêÜ",
                funcs: [
                    { func: 'get_equipment', name: 'Ëé∑ÂèñË£ÖÂ§á', args: { char_id: '123456' } },
                    { func: 'send_equipment', name: 'ÂèëÈÄÅË£ÖÂ§á', args: { char_id: '123456', equip_data: { 'pos': 1, 'id': 1001 } } },
                    { func: 'get_affix', name: 'Ëé∑ÂèñËØçÊù°', args: { char_id: '123456' } },
                    { func: 'modify_affix', name: '‰øÆÊîπËØçÊù°', args: { char_id: '123456', affix_data: { 'pos': 1, 'affix_list': ['Êó†Á∫ßÂà´'] } } }
                ]
            },
            gift: {
                name: "Áâ©ÂìÅËµ†ÈÄÅ (Â∑≤Âä†ÂÆâÂÖ®È™åËØÅ)",
                funcs: [
                    { func: 'give_item', name: 'Ëµ†ÈÄÅÈÅìÂÖ∑', args: { player_id: '123456', item_name: 'Á•ûÂÖµ', count: 10, item_category: 'default' } },
                    { func: 'give_gem', name: 'Ëµ†ÈÄÅÂÆùÁü≥', args: { player_id: '123456', gem_name: 'Â§™Èò≥Áü≥', min_level: 1, max_level: 10 } },
                    { func: 'get_recharge_types', name: 'Ëé∑ÂèñÂÖÖÂÄºÁ±ªÂûã', args: {} },
                    { func: 'get_recharge_card', name: 'Ëé∑ÂèñÂÖÖÂÄºÂç°Âè∑', args: { selected_type: 'vip_card' } },
                    { func: 'generate_cdk', name: 'ÁîüÊàêCDK', args: { selected_type: 'gift_1', gen_data: { count: 10, value: 100 } } },
                    { func: 'generate_custom_cdk', name: 'ÁîüÊàêËá™ÂÆö‰πâCDK', args: { selected_type: 'custom_1', gen_data: { count: 5, items: ['ÈÅìÂÖ∑1', 'ÈÅìÂÖ∑2'] } } },
                    { func: 'new_recharge_type', name: 'Êñ∞Âª∫ÂÖÖÂÄºÁ±ªÂûã', args: { type_name: 'new_vip' } },
                    { func: 'del_recharge_type', name: 'Âà†Èô§ÂÖÖÂÄºÁ±ªÂûã', args: { selected_type: 'old_vip', type_name: 'old_vip' } }
                ]
            },
            character: {
                name: "ËßíËâ≤ÁÆ°ÁêÜ",
                funcs: [
                    { func: 'get_character_info', name: 'Ëé∑ÂèñËßíËâ≤‰ø°ÊÅØ', args: { char_id: '123456' } },
                    { func: 'recover_character_props', name: 'ÊÅ¢Â§çËßíËâ≤ÈÅìÂÖ∑', args: { char_id: '123456' } },
                    { func: 'modify_character', name: '‰øÆÊîπËßíËâ≤', args: { char_id: '123456', modify_data_str: "{['Á≠âÁ∫ß']=175}" } }
                ]
            },
            game: {
                name: "Ê∏∏ÊàèÁÆ°ÁêÜ",
                funcs: [
                    { func: 'send_broadcast', name: 'ÂèëÈÄÅÂπøÊí≠', args: { content: 'ÊµãËØïÂπøÊí≠Ê∂àÊÅØ' } },
                    { func: 'send_announcement', name: 'ÂèëÈÄÅÂÖ¨Âëä', args: { content: 'ÊµãËØïÁ≥ªÁªüÂÖ¨Âëä' } },
                    { func: 'set_exp_rate', name: 'ËÆæÁΩÆÁªèÈ™åÂÄçÁéá', args: { rate: '2.0' } },
                    { func: 'set_difficulty', name: 'ËÆæÁΩÆÊ∏∏ÊàèÈöæÂ∫¶', args: { rate: '1.5' } },
                    { func: 'set_level_cap', name: 'ËÆæÁΩÆÁ≠âÁ∫ß‰∏äÈôê', args: { rate: '200' } },
                    { func: 'trigger_activity', name: 'Ëß¶ÂèëÊ¥ªÂä®', args: { activity_name: 'ÂèåÂÄçÁªèÈ™å' } }
                ]
            }
        };

        let currentModule = 'account';
        let currentFunc = null;

        // È°µÈù¢Âä†ËΩΩÊó∂Ê£ÄÊü•ÁôªÂΩïÁä∂ÊÄÅ
        window.addEventListener('DOMContentLoaded', async () => {
            if (accessToken) {
                await checkAuth();
            }
            init();
        });

        async function checkAuth() {
            try {
                const response = await fetch('/api/users/me', {
                    headers: { 'Authorization': `Bearer ${accessToken}` }
                });
                if (response.ok) {
                    const data = await response.json();
                    currentUser = data.user;
                    updateAuthUI(true);
                    log(`Ëá™Âä®ÁôªÂΩïÊàêÂäü: ${currentUser.username}`, 'success');
                } else {
                    accessToken = null;
                    localStorage.removeItem('api_tester_token');
                    updateAuthUI(false);
                }
            } catch (e) {
                accessToken = null;
                localStorage.removeItem('api_tester_token');
                updateAuthUI(false);
            }
        }

        function showLoginModal() {
            document.getElementById('loginModal').classList.add('show');
            document.getElementById('loginError').textContent = '';
        }

        function hideLoginModal() {
            document.getElementById('loginModal').classList.remove('show');
        }

        async function doLogin() {
            const username = document.getElementById('loginUsername').value.trim();
            const password = document.getElementById('loginPassword').value;
            const errorEl = document.getElementById('loginError');

            if (!username || !password) {
                errorEl.textContent = 'ËØ∑ËæìÂÖ•Áî®Êà∑ÂêçÂíåÂØÜÁ†Å';
                return;
            }

            try {
                const response = await fetch('/api/users/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, password })
                });

                const data = await response.json();

                if (response.ok) {
                    accessToken = data.access_token;
                    currentUser = data.user;
                    localStorage.setItem('api_tester_token', accessToken);
                    updateAuthUI(true);
                    hideLoginModal();
                    log(`ÁôªÂΩïÊàêÂäü: ${currentUser.username} (Level ${currentUser.level})`, 'success');
                } else {
                    errorEl.textContent = data.detail || 'ÁôªÂΩïÂ§±Ë¥•';
                }
            } catch (e) {
                errorEl.textContent = `ÁôªÂΩïÈîôËØØ: ${e.message}`;
            }
        }

        function logout() {
            accessToken = null;
            currentUser = null;
            localStorage.removeItem('api_tester_token');
            updateAuthUI(false);
            log('Â∑≤ÈÄÄÂá∫ÁôªÂΩï', 'info');
        }

        function updateAuthUI(isLoggedIn) {
            const statusEl = document.getElementById('authStatus');
            const loginBtn = document.getElementById('loginBtn');
            const logoutBtn = document.getElementById('logoutBtn');

            if (isLoggedIn && currentUser) {
                statusEl.textContent = `${currentUser.username} (Lv.${currentUser.level})`;
                statusEl.className = 'auth-status logged-in';
                loginBtn.style.display = 'none';
                logoutBtn.style.display = 'block';
            } else {
                statusEl.textContent = 'Êú™ÁôªÂΩï';
                statusEl.className = 'auth-status logged-out';
                loginBtn.style.display = 'block';
                logoutBtn.style.display = 'none';
            }
        }

        function init() {
            const moduleList = document.getElementById('moduleList');
            for (const [key, value] of Object.entries(MODULES)) {
                const li = document.createElement('li');
                li.className = `module-item ${key === currentModule ? 'active' : ''}`;
                li.innerText = `${value.name} (${key})`;
                li.onclick = () => selectModule(key);
                moduleList.appendChild(li);
            }
            selectModule(currentModule);
        }

        function selectModule(moduleName) {
            currentModule = moduleName;
            document.querySelectorAll('.module-item').forEach(el => {
                el.classList.remove('active');
                if (el.innerText.includes(`(${moduleName})`)) el.classList.add('active');
            });

            const functionBar = document.getElementById('functionBar');
            functionBar.innerHTML = '';
            const funcs = MODULES[moduleName].funcs;

            funcs.forEach((f, index) => {
                const btn = document.createElement('div');
                btn.className = 'func-btn';
                btn.innerText = f.name;
                btn.onclick = () => selectFunction(f);
                functionBar.appendChild(btn);
                if (index === 0) selectFunction(f);
            });
        }

        function selectFunction(funcObj) {
            currentFunc = funcObj;
            document.querySelectorAll('.func-btn').forEach(el => {
                el.classList.remove('active');
                if (el.innerText === funcObj.name) el.classList.add('active');
            });

            document.getElementById('currentFuncTitle').innerText = `${funcObj.name} (${funcObj.func})`;

            const formInputs = document.getElementById('formInputs');
            formInputs.innerHTML = '';

            for (const [argName, argValue] of Object.entries(funcObj.args)) {
                const group = document.createElement('div');
                group.className = 'form-group';

                const label = document.createElement('label');
                label.className = 'form-label';
                label.innerText = argName;

                let input;
                if (typeof argValue === 'object') {
                    input = document.createElement('textarea');
                    input.rows = 5;
                    input.value = JSON.stringify(argValue, null, 2);
                } else {
                    input = document.createElement('input');
                    input.type = 'text';
                    input.value = argValue;
                }
                input.className = 'form-input';
                input.id = `arg-${argName}`;
                input.dataset.type = typeof argValue;

                group.appendChild(label);
                group.appendChild(input);
                formInputs.appendChild(group);
            }
        }

        function getArgs() {
            if (!currentFunc) return {};
            const args = {};
            for (const [argName, argValue] of Object.entries(currentFunc.args)) {
                const input = document.getElementById(`arg-${argName}`);
                if (input.dataset.type === 'object') {
                    try {
                        args[argName] = JSON.parse(input.value);
                    } catch (e) {
                        alert(`ÂèÇÊï∞ ${argName} JSON Ê†ºÂºèÈîôËØØ`);
                        return null;
                    }
                } else if (input.dataset.type === 'number') {
                    args[argName] = Number(input.value);
                } else {
                    args[argName] = input.value;
                }
            }
            return args;
        }

        async function executeRequest() {
            if (!currentFunc) return;

            if (!accessToken) {
                log('ËØ∑ÂÖàÁôªÂΩïÔºÅ', 'error');
                showLoginModal();
                return;
            }

            const args = getArgs();
            if (!args) return;

            const url = `${API_BASE}/${currentModule}`;
            const payload = {
                function: currentFunc.func,
                args: args
            };

            log(`Sending POST ${url}`, 'info');
            log(`Payload: ${JSON.stringify(payload)}`, 'info');

            try {
                const startTime = Date.now();
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${accessToken}`
                    },
                    body: JSON.stringify(payload)
                });

                const endTime = Date.now();
                const duration = endTime - startTime;

                const data = await response.json();

                if (response.ok) {
                    log(`Success (${duration}ms): ${JSON.stringify(data, null, 2)}`, 'success');
                } else {
                    log(`Error ${response.status} (${duration}ms): ${JSON.stringify(data, null, 2)}`, 'error');
                    if (response.status === 401) {
                        log('Token Â∑≤ËøáÊúüÔºåËØ∑ÈáçÊñ∞ÁôªÂΩï', 'error');
                        logout();
                    }
                }
            } catch (e) {
                log(`Exception: ${e.message}`, 'error');
            }
        }

        function log(message, type = 'info') {
            const consoleOutput = document.getElementById('consoleOutput');
            const entry = document.createElement('div');
            entry.className = 'log-entry';

            const time = new Date().toLocaleTimeString();
            const statusClass = type === 'success' ? 'log-status success' : (type === 'error' ? 'log-status error' : '');

            entry.innerHTML = `
            <div>
                <span class="log-time">[${time}]</span>
                <span class="log-method">${currentModule.toUpperCase()}.${currentFunc ? currentFunc.func : 'System'}</span>
                <span class="${statusClass}">${type.toUpperCase()}</span>
            </div>
            <code class="log-data">${message}</code>
        `;

            consoleOutput.appendChild(entry);
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
        }

        function clearConsole() {
            document.getElementById('consoleOutput').innerHTML = '';
        }

        function copyCurl() {
            if (!currentFunc) return;
            if (!accessToken) {
                alert('ËØ∑ÂÖàÁôªÂΩï');
                return;
            }

            const args = getArgs();
            if (!args) return;

            const url = `${window.location.origin}${API_BASE}/${currentModule}`;
            const payload = {
                function: currentFunc.func,
                args: args
            };

            const curl = `curl -X POST "${url}" \\
  -H "Content-Type: application/json" \\
  -H "Authorization: Bearer ${accessToken}" \\
  -d '${JSON.stringify(payload)}'`;

            navigator.clipboard.writeText(curl).then(() => {
                log('cURL command copied to clipboard', 'info');
            });
        }
    </script>

</body>

</html>